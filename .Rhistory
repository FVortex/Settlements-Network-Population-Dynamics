scale_x_continuous(name = "Расстояние от центра кластера (км)")
View(clusters_18_metrics)
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000, 10000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(300, 500, 1000, 2000, 10000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(300, 500, 1000, 2000, 10000),
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000, 10000),
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000),
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(trans = "log")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
# breaks = c(0, 300, 500, 1000, 2000),
# labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# Сохраним данные в новую переменную и очистим от лишних столбцов
df <- settlements_2002@data
df %>%
select(-cohort1981, -cohort1990, -cohort2002,
-trend_1981to1990, -trend_1990to2002,
-rel1981to1990, -rel1990to2002, -rel2002to2010) -> df
df %>%
group_by(clust_18) %>%
mutate(pop2002 = sum(Census2002), pop2010 = sum(Census2010),
pop2010to2002_rel = pop2010/pop2002*100,         # отношение населения в 2010 году к населению в 2002
max_pop = max(Census2002),                       # величина крупнешего н.п.
mean_pop = mean(Census2002),                     # средний размер н.п.
median_pop = median(Census2002),                 # медианный размер н.п.
sum_pop = sum(Census2002)) %>%                   # сумма населения кластера
select(clust_6, clust_18, pop2002, pop2010, pop2010to2002_rel, mean_pop, max_pop, sum_pop) %>%
unique() -> clusters_18_metrics                         # Сохраним результат в новый data.frame
# Создадим переменные
clusters_18_metrics$variation_2002 <- NA_real_
clusters_18_metrics$variation_2010 <- NA_real_
for (i in 1:nrow(clusters_18_metrics)) {
# Define logical vector to subset observations by the cluster
select_condition <- clust_18_2002 == i
settlements_temp <- df[select_condition,]
# Calculate variation (standart deviation(x)/mean(x))
# 2002
clusters_18_metrics[clusters_18_metrics$clust_18 == i,]$variation_2002 <-
sd(settlements_temp$Census2002, na.rm = T)/mean(settlements_temp$Census2002, na.rm = T)
# 2010
clusters_18_metrics[clusters_18_metrics$clust_18 == i,]$variation_2010 <-
sd(settlements_temp$Census2010, na.rm = T)/mean(settlements_temp$Census2010, na.rm = T)
}
# Calculate the difference in variance between 2002 and 2010 (темпы сжатия расселения)
clusters_18_metrics %>%
mutate(variation_dif = variation_2010/variation_2002*100) ->
clusters_18_metrics
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot()+
geom_point(aes(x=variation_dif, y=pop2010to2002_rel, size = mean_pop))+
geom_smooth(aes(x=variation_dif, y=pop2010to2002_rel), method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации")+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs средний размер населенных пунктов
clusters_18_metrics %>%
ggplot()+
geom_point(aes(y=mean_pop, x=variation_dif))+
geom_smooth(aes(y=mean_pop, x=variation_dif), method = "glm")+
scale_y_continuous(trans = "log")+
scale_x_continuous(name = "Изменение вариации")
clusters_18_metrics$dist2Tyumen <- NA_real_
for (i in 1:nrow(clusters_18_metrics)) {
# Define logical vector to subset observations by the cluster
select_condition <- clust_18_2002 == i
settlements_temp <- df[select_condition,]
# Subset distance matrix: by row - cluster members, by column - Tyumen
distances_to_Tyumen <- dist_matrix_2002[select_condition, df$ShortName == "г. Тюмень"]
# Weight by population proportion
res <- sum(distances_to_Tyumen * settlements_temp$Census2002/sum(settlements_temp$Census2002))
# Save to res cell
clusters_18_metrics[clusters_18_metrics$clust_18 == i,]$dist2Tyumen <- res
}
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000),
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = median_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
df %>%
group_by(clust_18) %>%
mutate(pop2002 = sum(Census2002), pop2010 = sum(Census2010),
pop2010to2002_rel = pop2010/pop2002*100,         # отношение населения в 2010 году к населению в 2002
max_pop = max(Census2002),                       # величина крупнешего н.п.
mean_pop = mean(Census2002),                     # средний размер н.п.
median_pop = median(Census2002),                 # медианный размер н.п.
sum_pop = sum(Census2002)) %>%                   # сумма населения кластера
select(clust_6, clust_18, pop2002, pop2010, pop2010to2002_rel, mean_pop, max_pop, sum_pop) %>%
unique() -> clusters_18_metrics                         # Сохраним результат в новый data.frame
View(clusters_18_metrics)
df %>%
group_by(clust_18) %>%
mutate(pop2002 = sum(Census2002), pop2010 = sum(Census2010),
pop2010to2002_rel = pop2010/pop2002*100,         # отношение населения в 2010 году к населению в 2002
max_pop = max(Census2002),                       # величина крупнешего н.п.
mean_pop = mean(Census2002),                     # средний размер н.п.
median_pop = median(Census2002),                 # медианный размер н.п.
sum_pop = sum(Census2002)) %>%                   # сумма населения кластера
select(clust_6, clust_18, pop2002, pop2010, pop2010to2002_rel, mean_pop,median_pop, max_pop, sum_pop) %>%
unique() -> clusters_18_metrics                         # Сохраним результат в новый data.frame
# Создадим переменные
clusters_18_metrics$variation_2002 <- NA_real_
clusters_18_metrics$variation_2010 <- NA_real_
for (i in 1:nrow(clusters_18_metrics)) {
# Define logical vector to subset observations by the cluster
select_condition <- clust_18_2002 == i
settlements_temp <- df[select_condition,]
# Calculate variation (standart deviation(x)/mean(x))
# 2002
clusters_18_metrics[clusters_18_metrics$clust_18 == i,]$variation_2002 <-
sd(settlements_temp$Census2002, na.rm = T)/mean(settlements_temp$Census2002, na.rm = T)
# 2010
clusters_18_metrics[clusters_18_metrics$clust_18 == i,]$variation_2010 <-
sd(settlements_temp$Census2010, na.rm = T)/mean(settlements_temp$Census2010, na.rm = T)
}
# Calculate the difference in variance between 2002 and 2010 (темпы сжатия расселения)
clusters_18_metrics %>%
mutate(variation_dif = variation_2010/variation_2002*100) ->
clusters_18_metrics
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot()+
geom_point(aes(x=variation_dif, y=pop2010to2002_rel, size = mean_pop))+
geom_smooth(aes(x=variation_dif, y=pop2010to2002_rel), method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации")+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs средний размер населенных пунктов
clusters_18_metrics %>%
ggplot()+
geom_point(aes(y=mean_pop, x=variation_dif))+
geom_smooth(aes(y=mean_pop, x=variation_dif), method = "glm")+
scale_y_continuous(trans = "log")+
scale_x_continuous(name = "Изменение вариации")
clusters_18_metrics$dist2Tyumen <- NA_real_
for (i in 1:nrow(clusters_18_metrics)) {
# Define logical vector to subset observations by the cluster
select_condition <- clust_18_2002 == i
settlements_temp <- df[select_condition,]
# Subset distance matrix: by row - cluster members, by column - Tyumen
distances_to_Tyumen <- dist_matrix_2002[select_condition, df$ShortName == "г. Тюмень"]
# Weight by population proportion
res <- sum(distances_to_Tyumen * settlements_temp$Census2002/sum(settlements_temp$Census2002))
# Save to res cell
clusters_18_metrics[clusters_18_metrics$clust_18 == i,]$dist2Tyumen <- res
}
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = median_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
clusters_18_metrics %>%
ggplot(aes(x=median_pop, y=pop2010to2002_rel))
clusters_18_metrics %>%
ggplot(aes(x=median_pop, y=pop2010to2002_rel))+
geom_point()
clusters_18_metrics %>%
ggplot(aes(x=median_pop, y=variation_dif))+
geom_point()
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = median_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
clusters_18_metrics %>%
ggplot(aes(x=mean_pop, y=median_pop))+
geom_point()
clusters_18_metrics %>%
ggplot(aes(x=max_pop, y=median_pop))+
geom_point()
clusters_18_metrics %>%
ggplot(aes(x=max_pop, y=median_pop))+
geom_point()+
scale_x_continuous(trans = "log")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "log")+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
geom_point(aes(size = mean_pop)+
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "log")+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "log",
range = c(0.5, 3))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "log",
range = c(0.5, 4))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "sqrt",
range = c(0.5, 4))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
View(clusters_18_metrics)
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "sqrt",
range = c(0.5, 4),
breaks = c(0, 5000, 7000, 20000, 100000),
# labels = c("<300", "300-499", "500-999", "1000-2000", ">8000")
)+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(trans = "sqrt",
range = c(0.5, 4),
breaks = c(0, 5000, 7000, 20000, 100000),
labels = c("<5", "5-7", "7-20", "20-100", ">100")
)+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(name = "Крупнейший центр\n(тыс. чел.)",
trans = "sqrt",
range = c(0.5, 4),
breaks = c(0, 5000, 7000, 20000, 100000),
labels = c("<5", "5-7", "7-20", "20-100", ">100")
)+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = max_pop))+
geom_smooth(method = "glm")+
# scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
#                       breaks = c(0, 300, 500, 1000, 2000),
#                       labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_size_continuous(name = "Крупнейший н.п.\n(тыс. чел.)",
trans = "sqrt",
range = c(0.5, 4),
breaks = c(0, 5000, 7000, 20000, 100000),
labels = c("<5", "5-7", "7-20", "20-100", ">100")
)+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# 3.4.1. Quick explorative analysis
# Удаленность от Тюмени vs динамика населения
clusters_18_metrics %>%
ggplot(aes(x=dist2Tyumen/1000, y=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000),
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика населения (%)")+
scale_x_continuous(name = "Расстояние от центра кластера (км)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot()+
geom_point(aes(x=variation_dif, y=pop2010to2002_rel, size = mean_pop))+
geom_smooth(aes(x=variation_dif, y=pop2010to2002_rel), method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации")+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot()+
geom_point(aes(x=variation_dif, y=pop2010to2002_rel, size = mean_pop))+
geom_smooth(aes(x=variation_dif, y=pop2010to2002_rel), method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации", breaks = seq(100, 115, 5))+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot()+
geom_point(aes(x=variation_dif, y=pop2010to2002_rel, size = mean_pop))+
geom_smooth(aes(x=variation_dif, y=pop2010to2002_rel), method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации", breaks = seq(100, 115, 5),
limits = c(100, 115))+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot()+
geom_point(aes(x=variation_dif, y=pop2010to2002_rel, size = mean_pop))+
geom_smooth(aes(x=variation_dif, y=pop2010to2002_rel), method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации", breaks = seq(100, 115, 5),
limits = c(100, 115))+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot(aes(y=variation_dif, x=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_x_continuous(name = "Изменение вариации", breaks = seq(100, 115, 5),
limits = c(100,115))+
scale_y_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot(aes(y=variation_dif, x=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Изменение вариации", breaks = seq(100, 115, 5),
limits = c(100,115))+
scale_x_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot(aes(y=variation_dif, x=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика территориальной\nдифференциации расселения", breaks = seq(100, 115, 5),
limits = c(100,115))+
scale_x_continuous(name = "Динамика населения (%)")
# Темпы сжатия расселения vs общая динамика населения
clusters_18_metrics %>%
ggplot(aes(y=variation_dif, x=pop2010to2002_rel))+
geom_point(aes(size = mean_pop))+
# geom_smooth(method = "glm")+
scale_size_continuous(name = "Ср. размер\nн.п. (чел.)",
breaks = c(0, 300, 500, 1000, 2000), trans = "sqrt",
labels = c("<300", "300-499", "500-999", "1000-2000", ">8000"))+
scale_y_continuous(name = "Динамика территориальной\nдифференциации расселения", breaks = seq(100, 115, 5),
limits = c(100,115))+
scale_x_continuous(name = "Динамика населения (%)")
